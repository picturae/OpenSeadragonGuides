{"version":3,"sources":["webpack:///openseadragon-guides.js","webpack:///webpack/bootstrap 0d769f6870c414915f6d","webpack:///./src/globals.js","webpack:///./src/session.js","webpack:///./src/guide.js","webpack:///./src/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","$","OpenSeadragon","DIRECTION_HORIZONTAL","Symbol","DIRECTION_VERTICAL","addGuide","id","x","y","dir","rotation","direction","guidesList","getGuides","guide","find","push","saveData","deleteGuide","filter","data","window","sessionStorage","getItem","STORAGE_ID","JSON","parse","arr","setItem","stringify","default","useStorage","_classCallCheck","instance","Constructor","TypeError","createElem","elem","document","createElement","classList","add","Error","createLine","lineElem","Guide","undefined","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","_session2","obj","_session","clickHandler","Date","now","plugin","viewer","this","point","viewport","getCenter","line","appendChild","overlay","Overlay","element","location","height","width","draw","saveInStorage","allowRotation","rotate","addHandlers","tracker","MouseTracker","clickTimeThreshold","clickDistThreshold","dragHandler","bind","dragEndHandler","dblClickHandler","remove","addHandler","event","delta","deltaPointsFromPixels","update","drawHTML","drawer","container","removeHandler","destroy","closePopup","deg","parseFloat","style","webkitTransform","transform","_toConsumableArray","Array","isArray","arr2","from","version","major","Viewer","guides","options","guidesInstance","Guides","extend","horizontalGuideButton","verticalGuideButton","prefixUrl","removeOnClose","useSessionStorage","navImages","guideHorizontal","REST","GROUP","HOVER","DOWN","guideVertical","prefix","useGroup","buttonGroup","buttons","anyButton","onFocus","onBlur","Button","getElement","tooltip","getString","srcRest","srcGroup","srcHover","srcDown","onRelease","createHorizontalGuide","createVerticalGuide","forEach","g","showPopup","popup","createRotationPopup","addControl","display","popupInput","querySelector","selectedGuide","index","indexOf","splice","removeAll","position","bottom","left","form","background","padding","input","type","fontSize","rotateButton","innerHTML","addEventListener","closeButton","title","fontWeight"],"mappings":"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","file":"openseadragon-guides.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n// Not importing Openseadragon into the bundle, use global var instead\nvar $ = exports.$ = OpenSeadragon;\n\nvar DIRECTION_HORIZONTAL = exports.DIRECTION_HORIZONTAL = Symbol('horizontal');\nvar DIRECTION_VERTICAL = exports.DIRECTION_VERTICAL = Symbol('vertical');\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _globals = __webpack_require__(0);\n\nvar useStorage = false;\nvar STORAGE_ID = 'openseadragon-guides';\n\n// Add new guide to sessionStorage\nfunction addGuide(id, x, y, dir, rotation) {\n  var direction = dir === _globals.DIRECTION_HORIZONTAL ? 'horizontal' : 'vertical';\n  var guidesList = getGuides();\n  // Check if guide with this id already exists\n  var guide = guidesList.find(function (guide) {\n    return guide.id === id;\n  });\n\n  // If guide exists update, otherwise create new one\n  if (guide) {\n    guide.x = x;\n    guide.y = y;\n    guide.rotation = rotation;\n  } else {\n    guidesList.push({ id: id, x: x, y: y, direction: direction, rotation: rotation });\n  }\n\n  saveData(guidesList);\n}\n\n// Removes guide from sessionStorage\nfunction deleteGuide(id) {\n  var guides = getGuides();\n\n  saveData(guides.filter(function (guide) {\n    return guide.id !== id;\n  }));\n}\n\n// Gets array with guides from sessionStorage\nfunction getGuides() {\n  var data = window.sessionStorage.getItem(STORAGE_ID);\n\n  if (data) {\n    return JSON.parse(data);\n  }\n\n  return [];\n}\n\n// Saves array with guides to sessionStorage\nfunction saveData(arr) {\n  window.sessionStorage.setItem(STORAGE_ID, JSON.stringify(arr));\n}\n\nexports.default = {\n  addGuide: addGuide,\n  deleteGuide: deleteGuide,\n  getGuides: getGuides,\n  useStorage: useStorage\n};\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Guide = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _globals = __webpack_require__(0);\n\nvar _session = __webpack_require__(1);\n\nvar _session2 = _interopRequireDefault(_session);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Guide = exports.Guide = function () {\n  function Guide(_ref) {\n    var clickHandler = _ref.clickHandler,\n        _ref$direction = _ref.direction,\n        direction = _ref$direction === undefined ? _globals.DIRECTION_HORIZONTAL : _ref$direction,\n        _ref$id = _ref.id,\n        id = _ref$id === undefined ? Date.now() : _ref$id,\n        plugin = _ref.plugin,\n        _ref$rotation = _ref.rotation,\n        rotation = _ref$rotation === undefined ? 0 : _ref$rotation,\n        viewer = _ref.viewer,\n        x = _ref.x,\n        y = _ref.y;\n\n    _classCallCheck(this, Guide);\n\n    this.viewer = viewer;\n    this.plugin = plugin;\n    this.direction = direction;\n    this.rotation = rotation;\n    this.id = id;\n\n    // Center guide by default\n    this.point = this.viewer.viewport.getCenter(true);\n    this.point.x = x ? x : this.point.x;\n    this.point.y = y ? y : this.point.y;\n\n    this.elem = createElem(this.direction, this.id);\n    this.line = createLine();\n    this.elem.appendChild(this.line);\n\n    if (direction === _globals.DIRECTION_VERTICAL) {\n      this.point.y = -10;\n      this.overlay = new _globals.$.Overlay({\n        element: this.elem,\n        location: this.point,\n        height: 20,\n        width: 0.0001\n      });\n    } else {\n      this.point.x = -10;\n      this.overlay = new _globals.$.Overlay({\n        element: this.elem,\n        location: this.point,\n        width: 20,\n        height: 0.0001\n      });\n    }\n\n    this.draw();\n\n    // Store guide in session\n    this.saveInStorage();\n\n    if (clickHandler && this.plugin.allowRotation) {\n      this.clickHandler = clickHandler;\n    }\n\n    if (this.plugin.allowRotation) {\n      this.rotate(this.rotation);\n    }\n\n    this.addHandlers();\n  }\n\n  /**\n   * @private\n   */\n\n\n  _createClass(Guide, [{\n    key: 'addHandlers',\n    value: function addHandlers() {\n      // Listen for mouse events on the guide\n      this.tracker = new _globals.$.MouseTracker({\n        element: this.elem,\n        clickTimeThreshold: this.viewer.clickTimeThreshold,\n        clickDistThreshold: this.viewer.clickDistThreshold,\n        dragHandler: this.dragHandler.bind(this),\n        dragEndHandler: this.dragEndHandler.bind(this),\n        dblClickHandler: this.remove.bind(this)\n      });\n\n      if (this.clickHandler) {\n        this.tracker.clickHandler = this.clickHandler.bind(this);\n      }\n\n      // Redraw guide when viewer changes\n      this.viewer.addHandler('open', this.draw.bind(this));\n      this.viewer.addHandler('animation', this.draw.bind(this));\n      this.viewer.addHandler('resize', this.draw.bind(this));\n      this.viewer.addHandler('rotate', this.draw.bind(this));\n    }\n\n    /**\n     * @private\n     * @param event\n     */\n\n  }, {\n    key: 'dragHandler',\n    value: function dragHandler(event) {\n      var delta = this.viewer.viewport.deltaPointsFromPixels(event.delta, true);\n\n      switch (this.direction) {\n        case _globals.DIRECTION_HORIZONTAL:\n          this.point.y += delta.y;\n          break;\n        case _globals.DIRECTION_VERTICAL:\n          this.point.x += delta.x;\n          break;\n      }\n\n      // Add css class so we can change mouse cursor with css\n      this.elem.classList.add('osd-guide-drag');\n      this.draw();\n    }\n\n    /**\n     * @private\n     */\n\n  }, {\n    key: 'dragEndHandler',\n    value: function dragEndHandler() {\n      this.elem.classList.remove('osd-guide-drag');\n      this.saveInStorage();\n    }\n\n    /**\n     * Draws html element in the OpenSeadragon viewer\n     * @private\n     * @returns {Guide}\n     */\n\n  }, {\n    key: 'draw',\n    value: function draw() {\n      if (this.point) {\n        this.overlay.update(this.point);\n        this.overlay.drawHTML(this.viewer.drawer.container, this.viewer.viewport);\n      }\n\n      return this;\n    }\n\n    /**\n     * Destroys the guide instance and removes it from the session. Note that the object itself keeps existing.\n     * @returns {Guide} The guide that was destroyed.\n     */\n\n  }, {\n    key: 'remove',\n    value: function remove() {\n      this.viewer.removeHandler('open', this.draw.bind(this));\n      this.viewer.removeHandler('animation', this.draw.bind(this));\n      this.viewer.removeHandler('resize', this.draw.bind(this));\n      this.viewer.removeHandler('rotate', this.draw.bind(this));\n\n      this.overlay.destroy();\n      this.point = null;\n\n      _session2.default.deleteGuide(this.id);\n\n      if (this.plugin.allowRotation) {\n        this.plugin.closePopup();\n      }\n\n      return this;\n    }\n\n    /**\n     * Rotates guide by degrees (css transform)\n     * @param deg\n     */\n\n  }, {\n    key: 'rotate',\n    value: function rotate(deg) {\n      if (parseFloat(deg)) {\n        switch (this.direction) {\n          case _globals.DIRECTION_HORIZONTAL:\n            this.line.style.webkitTransform = 'rotateZ(' + deg + 'deg)';\n            this.line.style.transform = 'rotateZ(' + deg + 'deg)';\n            break;\n          case _globals.DIRECTION_VERTICAL:\n            this.line.style.webkitTransform = 'rotateZ(' + deg + 'deg)';\n            this.line.style.transform = 'rotateZ(' + deg + 'deg)';\n            break;\n        }\n        this.rotation = deg;\n      } else {\n        this.line.style.webkitTransform = '';\n        this.line.style.transform = '';\n        this.rotation = 0;\n      }\n      this.saveInStorage();\n    }\n\n    /**\n     * Adds guide to sessionStorage when useStorage option is set\n     */\n\n  }, {\n    key: 'saveInStorage',\n    value: function saveInStorage() {\n      if (_session2.default.useStorage) {\n        _session2.default.addGuide(this.id, this.point.x, this.point.y, this.direction, this.rotation);\n      }\n    }\n  }]);\n\n  return Guide;\n}();\n\n/**\n * Creates DOM element representing the guide\n * @param {DIRECTION_HORIZONTAL | DIRECTION_VERTICAL} direction The direction of the guide to create the element for.\n * @param {string} id The id for the guide.\n * @returns {HTMLDivElement}\n */\n\n\nfunction createElem(direction, id) {\n  var elem = document.createElement('div');\n  elem.id = 'osd-guide-' + id;\n  elem.classList.add('osd-guide');\n\n  switch (direction) {\n    case _globals.DIRECTION_HORIZONTAL:\n      elem.classList.add('osd-guide-horizontal');\n      break;\n    case _globals.DIRECTION_VERTICAL:\n      elem.classList.add('osd-guide-vertical');\n      break;\n    default:\n      throw new Error('Invalid guide direction');\n  }\n\n  return elem;\n}\n\n/**\n * Creates DOM element which is used to visually (by css) show the guideline\n * @returns {HTMLDivElement}\n */\nfunction createLine() {\n  var lineElem = document.createElement('div');\n  lineElem.classList.add('osd-guide-line');\n  return lineElem;\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _guide = __webpack_require__(2);\n\nvar _globals = __webpack_require__(0);\n\nvar _session = __webpack_require__(1);\n\nvar _session2 = _interopRequireDefault(_session);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nif (!_globals.$.version || _globals.$.version.major < 5) {\n  throw new Error('This version of OpenSeadragon Guides requires OpenSeadragon version 5.0.0+');\n}\n\n// Add new instance of Guides plugin to the viewers prototype\n_globals.$.Viewer.prototype.guides = function (options) {\n  if (!this.guidesInstance || options) {\n    options = options || {};\n    options.viewer = this;\n    this.guidesInstance = new _globals.$.Guides(options);\n  }\n\n  return this.guidesInstance;\n};\n\n_globals.$.Guides = function (options) {\n  var _this = this;\n\n  _globals.$.extend(true, this, {\n    // internal state properties\n    viewer: null,\n    guides: [],\n\n    // Default options\n    allowRotation: false,\n    horizontalGuideButton: null,\n    verticalGuideButton: null,\n    prefixUrl: null,\n    removeOnClose: false,\n    useSessionStorage: false,\n    navImages: {\n      guideHorizontal: {\n        REST: 'guidehorizontal_rest.png',\n        GROUP: 'guidehorizontal_grouphover.png',\n        HOVER: 'guidehorizontal_hover.png',\n        DOWN: 'guidehorizontal_pressed.png'\n      },\n      guideVertical: {\n        REST: 'guidevertical_rest.png',\n        GROUP: 'guidevertical_grouphover.png',\n        HOVER: 'guidevertical_hover.png',\n        DOWN: 'guidevertical_pressed.png'\n      }\n    }\n  }, options);\n\n  // Add plugin buttons to the viewer\n  _globals.$.extend(true, this.navImages, this.viewer.navImages);\n\n  // Openseadragon button behaviour, make sure the plugin's buttons act the\n  // same as the default buttons from the viewer\n  var prefix = this.prefixUrl || this.viewer.prefixUrl || '';\n  var useGroup = this.viewer.buttonGroup && this.viewer.buttonGroup.buttons;\n  var anyButton = useGroup ? this.viewer.buttons.buttons[0] : null;\n  var onFocus = anyButton ? anyButton.onFocus : null;\n  var onBlur = anyButton ? anyButton.onBlur : null;\n\n  this.horizontalGuideButton = new _globals.$.Button({\n    element: this.horizontalGuideButton ? _globals.$.getElement(this.horizontalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: _globals.$.getString('Tooltips.HorizontalGuide') || 'Horizontal guide',\n    srcRest: prefix + this.navImages.guideHorizontal.REST,\n    srcGroup: prefix + this.navImages.guideHorizontal.GROUP,\n    srcHover: prefix + this.navImages.guideHorizontal.HOVER,\n    srcDown: prefix + this.navImages.guideHorizontal.DOWN,\n    onRelease: this.createHorizontalGuide.bind(this),\n    onFocus: onFocus,\n    onBlur: onBlur\n  });\n\n  this.verticalGuideButton = new _globals.$.Button({\n    element: this.verticalGuideButton ? _globals.$.getElement(this.verticalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: _globals.$.getString('Tooltips.VerticalGuide') || 'vertical guide',\n    srcRest: prefix + this.navImages.guideVertical.REST,\n    srcGroup: prefix + this.navImages.guideVertical.GROUP,\n    srcHover: prefix + this.navImages.guideVertical.HOVER,\n    srcDown: prefix + this.navImages.guideVertical.DOWN,\n    onRelease: this.createVerticalGuide.bind(this),\n    onFocus: onFocus,\n    onBlur: onBlur\n  });\n\n  if (useGroup) {\n    this.viewer.buttonGroup.buttons.push(this.horizontalGuideButton);\n    this.viewer.buttonGroup.element.appendChild(this.horizontalGuideButton.element);\n    this.viewer.buttonGroup.buttons.push(this.verticalGuideButton);\n    this.viewer.buttonGroup.element.appendChild(this.verticalGuideButton.element);\n  }\n\n  // Store globally so it can be used in the Guide objects\n  _session2.default.useStorage = this.useSessionStorage;\n\n  // Check if any guides are stored in sessionStorage\n  if (_session2.default.useStorage) {\n    var guides = _session2.default.getGuides();\n\n    // Creates a new Guide instance for every item in sessionStorage\n    guides.forEach(function (guide) {\n      var g = new _guide.Guide({\n        viewer: _this.viewer,\n        direction: guide.direction === 'horizontal' ? _globals.DIRECTION_HORIZONTAL : _globals.DIRECTION_VERTICAL,\n        rotation: guide.rotation,\n        id: guide.id,\n        clickHandler: function clickHandler() {\n          return _this.showPopup(g);\n        },\n        plugin: _this,\n        x: guide.x,\n        y: guide.y\n      });\n\n      _this.guides.push(g);\n    });\n  }\n\n  // Remove guides when viewer closes\n  if (this.removeOnClose) {\n    this.viewer.addHandler('close', function () {\n      _this.guides.forEach(function (guide) {\n        return guide.remove();\n      });\n      _this.guides = [];\n    });\n  }\n\n  // A popup for user input is needed when rotation is allowed\n  if (this.allowRotation) {\n    this.popup = this.createRotationPopup();\n    this.viewer.addControl(this.popup, {});\n    this.popup.style.display = 'none';\n    this.popupInput = this.popup.querySelector('input');\n  }\n};\n\n// Add methods to the plugin's prototype\n_globals.$.extend(_globals.$.Guides.prototype, {\n  /**\n   * Creates a new horizontal guide and adds it to the instance.\n   */\n  createHorizontalGuide: function createHorizontalGuide() {\n    var _this2 = this;\n\n    var guide = new _guide.Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: _globals.DIRECTION_HORIZONTAL,\n      clickHandler: function clickHandler() {\n        return _this2.showPopup(guide);\n      }\n    });\n    this.guides.push(guide);\n  },\n\n\n  /**\n   * Creates a new vertical guide and adds it to the instance.\n   */\n  createVerticalGuide: function createVerticalGuide() {\n    var _this3 = this;\n\n    var guide = new _guide.Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: _globals.DIRECTION_VERTICAL,\n      clickHandler: function clickHandler() {\n        return _this3.showPopup(guide);\n      }\n    });\n    this.guides.push(guide);\n  },\n\n\n  /**\n   * Shows the rotation popup for the given guide.\n   * @param {Guide} guide\n   */\n  showPopup: function showPopup(guide) {\n    this.popup.style.display = 'block';\n    this.selectedGuide = guide;\n    this.popupInput.value = this.selectedGuide.rotation;\n  },\n\n\n  /**\n   * Closes the rotation popup.\n   */\n  closePopup: function closePopup() {\n    this.popup.style.display = 'none';\n    this.popupInput.value = '';\n    this.selectedGuide = null;\n  },\n\n\n  /**\n   * Destroys the given guide if it is part of the viewer and removes it from the list of active guides.\n   * @param {Guide} guide\n   */\n  remove: function remove(guide) {\n    var index = this.guides.indexOf(guide);\n\n    if (index === -1) {\n      return;\n    }\n\n    this.guides.splice(index, 1);\n    guide.remove();\n  },\n\n\n  /**\n   * Removes and destroys all current guides from the instance.\n   */\n  removeAll: function removeAll() {\n    // The spread operator is to make sure the guides are correctly deleted in order when at the same time removing\n    // them from the array.\n    var _arr = [].concat(_toConsumableArray(this.guides));\n\n    for (var _i = 0; _i < _arr.length; _i++) {\n      var guide = _arr[_i];\n      this.remove(guide);\n    }\n  },\n\n\n  // TODO: Refactor popup into new class\n  /**\n   * Creates a very basic popup for changing the rotation of the selected guide.\n   * @private\n   * @returns {HTMLDivElement}\n   */\n  createRotationPopup: function createRotationPopup() {\n    var _this4 = this;\n\n    var popup = document.createElement('div');\n    popup.id = 'osd-guide-popup';\n    popup.classList.add('osd-guide-popup');\n    popup.style.position = 'absolute';\n    popup.style.bottom = '10px';\n    popup.style.left = '10px';\n\n    var form = document.createElement('form');\n    form.classList.add('osd-guide-popup-form');\n    form.style.display = 'block';\n    form.style.position = 'relative';\n    form.style.background = '#fff';\n    form.style.padding = '10px';\n\n    popup.appendChild(form);\n\n    var input = document.createElement('input');\n    input.type = 'text';\n    input.style.display = 'inline-block';\n    input.style.width = '50px';\n    input.style.fontSize = '14px';\n    form.appendChild(input);\n\n    var rotateButton = document.createElement('button');\n    rotateButton.type = 'submit';\n    rotateButton.innerHTML = _globals.$.getString('Tool.rotate') || 'rotate';\n    rotateButton.style.fontSize = '14px';\n    rotateButton.classList.add('osd-guide-rotate-button');\n\n    rotateButton.addEventListener('click', function () {\n      _this4.selectedGuide.rotate(input.value);\n      _this4.closePopup();\n    });\n\n    form.appendChild(rotateButton);\n\n    var closeButton = document.createElement('button');\n    closeButton.innerHTML = '&times;';\n    closeButton.title = _globals.$.getString('Tool.close') || 'close';\n    closeButton.style.fontWeight = 'bold';\n    closeButton.style.fontSize = '14px';\n    closeButton.classList.add('osd-guide-close');\n    closeButton.addEventListener('click', function () {\n      _this4.closePopup();\n    });\n    form.appendChild(closeButton);\n\n    return popup;\n  }\n});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// openseadragon-guides.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0d769f6870c414915f6d","// Not importing Openseadragon into the bundle, use global var instead\nexport const $ = OpenSeadragon;\n\nexport const DIRECTION_HORIZONTAL = Symbol('horizontal');\nexport const DIRECTION_VERTICAL = Symbol('vertical');\n\n\n\n// WEBPACK FOOTER //\n// ./src/globals.js","import {DIRECTION_HORIZONTAL} from './globals';\n\nlet useStorage = false;\nconst STORAGE_ID = 'openseadragon-guides';\n\n// Add new guide to sessionStorage\nfunction addGuide(id, x, y, dir, rotation) {\n  const direction = dir === DIRECTION_HORIZONTAL ? 'horizontal' : 'vertical';\n  const guidesList = getGuides();\n  // Check if guide with this id already exists\n  const guide = guidesList.find(guide => guide.id === id);\n\n  // If guide exists update, otherwise create new one\n  if (guide) {\n    guide.x = x;\n    guide.y = y;\n    guide.rotation = rotation;\n  } else {\n    guidesList.push({id, x, y, direction, rotation});\n  }\n\n  saveData(guidesList);\n}\n\n// Removes guide from sessionStorage\nfunction deleteGuide(id) {\n  const guides = getGuides();\n\n  saveData(guides.filter(guide => guide.id !== id));\n}\n\n// Gets array with guides from sessionStorage\nfunction getGuides() {\n  const data = window.sessionStorage.getItem(STORAGE_ID);\n\n  if (data) {\n    return JSON.parse(data);\n  }\n\n  return [];\n}\n\n// Saves array with guides to sessionStorage\nfunction saveData(arr) {\n  window.sessionStorage.setItem(\n    STORAGE_ID,\n    JSON.stringify(arr)\n  );\n}\n\nexport default {\n  addGuide,\n  deleteGuide,\n  getGuides,\n  useStorage\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/session.js","import {$, DIRECTION_HORIZONTAL, DIRECTION_VERTICAL} from './globals';\nimport session from './session';\n\nexport class Guide {\n\n  constructor({\n    clickHandler,\n    direction = DIRECTION_HORIZONTAL,\n    id = Date.now(),\n    plugin,\n    rotation = 0,\n    viewer,\n    x,\n    y\n  }) {\n    this.viewer = viewer;\n    this.plugin = plugin;\n    this.direction = direction;\n    this.rotation = rotation;\n    this.id = id;\n\n    // Center guide by default\n    this.point = this.viewer.viewport.getCenter(true);\n    this.point.x = x ? x : this.point.x;\n    this.point.y = y ? y : this.point.y;\n\n    this.elem = createElem(this.direction, this.id);\n    this.line = createLine();\n    this.elem.appendChild(this.line);\n\n    if (direction === DIRECTION_VERTICAL) {\n      this.point.y = -10;\n      this.overlay = new $.Overlay({\n        element: this.elem,\n        location: this.point,\n        height: 20,\n        width: 0.0001\n      });\n    } else {\n      this.point.x = -10;\n      this.overlay = new $.Overlay({\n        element: this.elem,\n        location: this.point,\n        width: 20,\n        height: 0.0001\n      });\n    }\n\n    this.draw();\n\n    // Store guide in session\n    this.saveInStorage();\n\n    if(clickHandler && this.plugin.allowRotation) {\n      this.clickHandler = clickHandler;\n    }\n\n    if(this.plugin.allowRotation) {\n      this.rotate(this.rotation);\n    }\n\n    this.addHandlers();\n  }\n\n  /**\n   * @private\n   */\n  addHandlers() {\n    // Listen for mouse events on the guide\n    this.tracker = new $.MouseTracker({\n      element: this.elem,\n      clickTimeThreshold: this.viewer.clickTimeThreshold,\n      clickDistThreshold: this.viewer.clickDistThreshold,\n      dragHandler: this.dragHandler.bind(this),\n      dragEndHandler: this.dragEndHandler.bind(this),\n      dblClickHandler: this.remove.bind(this)\n    });\n\n    if (this.clickHandler) {\n      this.tracker.clickHandler = this.clickHandler.bind(this);\n    }\n\n    // Redraw guide when viewer changes\n    this.viewer.addHandler('open', this.draw.bind(this));\n    this.viewer.addHandler('animation', this.draw.bind(this));\n    this.viewer.addHandler('resize', this.draw.bind(this));\n    this.viewer.addHandler('rotate', this.draw.bind(this));\n  }\n\n  /**\n   * @private\n   * @param event\n   */\n  dragHandler(event) {\n    const delta = this.viewer.viewport.deltaPointsFromPixels(event.delta, true);\n\n    switch (this.direction) {\n      case DIRECTION_HORIZONTAL:\n        this.point.y += delta.y;\n        break;\n      case DIRECTION_VERTICAL:\n        this.point.x += delta.x;\n        break;\n    }\n\n    // Add css class so we can change mouse cursor with css\n    this.elem.classList.add('osd-guide-drag');\n    this.draw();\n  }\n\n  /**\n   * @private\n   */\n  dragEndHandler() {\n    this.elem.classList.remove('osd-guide-drag');\n    this.saveInStorage();\n  }\n\n  /**\n   * Draws html element in the OpenSeadragon viewer\n   * @private\n   * @returns {Guide}\n   */\n  draw() {\n    if (this.point) {\n      this.overlay.update(this.point);\n      this.overlay.drawHTML(this.viewer.drawer.container, this.viewer.viewport);\n    }\n\n    return this;\n  }\n\n  /**\n   * Destroys the guide instance and removes it from the session. Note that the object itself keeps existing.\n   * @returns {Guide} The guide that was destroyed.\n   */\n  remove() {\n    this.viewer.removeHandler('open', this.draw.bind(this));\n    this.viewer.removeHandler('animation', this.draw.bind(this));\n    this.viewer.removeHandler('resize', this.draw.bind(this));\n    this.viewer.removeHandler('rotate', this.draw.bind(this));\n\n    this.overlay.destroy();\n    this.point = null;\n\n    session.deleteGuide(this.id);\n\n    if (this.plugin.allowRotation) {\n      this.plugin.closePopup();\n    }\n\n    return this;\n  }\n\n  /**\n   * Rotates guide by degrees (css transform)\n   * @param deg\n   */\n  rotate(deg) {\n    if (parseFloat(deg)) {\n      switch (this.direction) {\n        case DIRECTION_HORIZONTAL:\n          this.line.style.webkitTransform = `rotateZ(${deg}deg)`;\n          this.line.style.transform = `rotateZ(${deg}deg)`;\n          break;\n        case DIRECTION_VERTICAL:\n          this.line.style.webkitTransform = `rotateZ(${deg}deg)`;\n          this.line.style.transform = `rotateZ(${deg}deg)`;\n          break;\n      }\n      this.rotation = deg;\n    } else {\n      this.line.style.webkitTransform = '';\n      this.line.style.transform = '';\n      this.rotation = 0;\n    }\n    this.saveInStorage();\n  }\n\n  /**\n   * Adds guide to sessionStorage when useStorage option is set\n   */\n  saveInStorage() {\n    if (session.useStorage) {\n      session.addGuide(\n        this.id,\n        this.point.x,\n        this.point.y,\n        this.direction,\n        this.rotation\n      );\n    }\n  }\n}\n\n/**\n * Creates DOM element representing the guide\n * @param {DIRECTION_HORIZONTAL | DIRECTION_VERTICAL} direction The direction of the guide to create the element for.\n * @param {string} id The id for the guide.\n * @returns {HTMLDivElement}\n */\nfunction createElem(direction, id) {\n  const elem = document.createElement('div');\n  elem.id = `osd-guide-${id}`;\n  elem.classList.add('osd-guide');\n\n  switch (direction) {\n    case DIRECTION_HORIZONTAL:\n      elem.classList.add('osd-guide-horizontal');\n      break;\n    case DIRECTION_VERTICAL:\n      elem.classList.add('osd-guide-vertical');\n      break;\n    default:\n      throw new Error('Invalid guide direction');\n  }\n\n  return elem;\n}\n\n/**\n * Creates DOM element which is used to visually (by css) show the guideline\n * @returns {HTMLDivElement}\n */\nfunction createLine() {\n  const lineElem = document.createElement('div');\n  lineElem.classList.add('osd-guide-line');\n  return lineElem;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/guide.js","import {Guide} from './guide';\nimport {$, DIRECTION_HORIZONTAL, DIRECTION_VERTICAL} from './globals';\nimport session from './session';\n\nif (!$.version || $.version.major < 5) {\n  throw new Error(\n    'This version of OpenSeadragon Guides requires OpenSeadragon version 5.0.0+'\n  );\n}\n\n// Add new instance of Guides plugin to the viewers prototype\n$.Viewer.prototype.guides = function(options) {\n  if (!this.guidesInstance || options) {\n    options = options || {};\n    options.viewer = this;\n    this.guidesInstance = new $.Guides(options);\n  }\n\n  return this.guidesInstance;\n};\n\n$.Guides = function(options) {\n  $.extend(true, this, {\n    // internal state properties\n    viewer: null,\n    guides: [],\n\n    // Default options\n    allowRotation: false,\n    horizontalGuideButton: null,\n    verticalGuideButton: null,\n    prefixUrl: null,\n    removeOnClose: false,\n    useSessionStorage: false,\n    navImages: {\n      guideHorizontal: {\n        REST: 'guidehorizontal_rest.png',\n        GROUP: 'guidehorizontal_grouphover.png',\n        HOVER: 'guidehorizontal_hover.png',\n        DOWN: 'guidehorizontal_pressed.png'\n      },\n      guideVertical: {\n        REST: 'guidevertical_rest.png',\n        GROUP: 'guidevertical_grouphover.png',\n        HOVER: 'guidevertical_hover.png',\n        DOWN: 'guidevertical_pressed.png'\n      }\n    }\n  }, options);\n\n  // Add plugin buttons to the viewer\n  $.extend(true, this.navImages, this.viewer.navImages);\n\n  // Openseadragon button behaviour, make sure the plugin's buttons act the\n  // same as the default buttons from the viewer\n  const prefix = this.prefixUrl || this.viewer.prefixUrl || '';\n  const useGroup = this.viewer.buttonGroup && this.viewer.buttonGroup.buttons;\n  const anyButton = useGroup ? this.viewer.buttons.buttons[0] : null;\n  const onFocus = anyButton ? anyButton.onFocus : null;\n  const onBlur = anyButton ? anyButton.onBlur : null;\n\n  this.horizontalGuideButton = new $.Button({\n    element: this.horizontalGuideButton ? $.getElement(this.horizontalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: $.getString('Tooltips.HorizontalGuide') || 'Horizontal guide',\n    srcRest: prefix + this.navImages.guideHorizontal.REST,\n    srcGroup: prefix + this.navImages.guideHorizontal.GROUP,\n    srcHover: prefix + this.navImages.guideHorizontal.HOVER,\n    srcDown: prefix + this.navImages.guideHorizontal.DOWN,\n    onRelease: this.createHorizontalGuide.bind(this),\n    onFocus,\n    onBlur\n  });\n\n  this.verticalGuideButton = new $.Button({\n    element: this.verticalGuideButton ? $.getElement(this.verticalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: $.getString('Tooltips.VerticalGuide') || 'vertical guide',\n    srcRest: prefix + this.navImages.guideVertical.REST,\n    srcGroup: prefix + this.navImages.guideVertical.GROUP,\n    srcHover: prefix + this.navImages.guideVertical.HOVER,\n    srcDown: prefix + this.navImages.guideVertical.DOWN,\n    onRelease: this.createVerticalGuide.bind(this),\n    onFocus,\n    onBlur\n  });\n\n  if (useGroup) {\n    this.viewer.buttonGroup.buttons.push(this.horizontalGuideButton);\n    this.viewer.buttonGroup.element.appendChild(this.horizontalGuideButton.element);\n    this.viewer.buttonGroup.buttons.push(this.verticalGuideButton);\n    this.viewer.buttonGroup.element.appendChild(this.verticalGuideButton.element);\n  }\n\n  // Store globally so it can be used in the Guide objects\n  session.useStorage = this.useSessionStorage;\n\n  // Check if any guides are stored in sessionStorage\n  if (session.useStorage) {\n    const guides = session.getGuides();\n\n    // Creates a new Guide instance for every item in sessionStorage\n    guides.forEach(guide => {\n      const g = new Guide({\n        viewer: this.viewer,\n        direction: guide.direction === 'horizontal' ?\n          DIRECTION_HORIZONTAL :\n          DIRECTION_VERTICAL,\n        rotation: guide.rotation,\n        id: guide.id,\n        clickHandler: () => this.showPopup(g),\n        plugin: this,\n        x: guide.x,\n        y: guide.y\n      });\n\n      this.guides.push(g);\n    });\n  }\n\n  // Remove guides when viewer closes\n  if (this.removeOnClose) {\n    this.viewer.addHandler('close', () => {\n      this.guides.forEach(guide => guide.remove());\n      this.guides = [];\n    });\n  }\n\n  // A popup for user input is needed when rotation is allowed\n  if (this.allowRotation) {\n    this.popup = this.createRotationPopup();\n    this.viewer.addControl(this.popup, {});\n    this.popup.style.display = 'none';\n    this.popupInput = this.popup.querySelector('input');\n  }\n};\n\n// Add methods to the plugin's prototype\n$.extend($.Guides.prototype, {\n  /**\n   * Creates a new horizontal guide and adds it to the instance.\n   */\n  createHorizontalGuide() {\n    const guide = new Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: DIRECTION_HORIZONTAL,\n      clickHandler: () => this.showPopup(guide)\n    });\n    this.guides.push(guide);\n  },\n\n  /**\n   * Creates a new vertical guide and adds it to the instance.\n   */\n  createVerticalGuide() {\n    const guide = new Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: DIRECTION_VERTICAL,\n      clickHandler: () => this.showPopup(guide)\n    });\n    this.guides.push(guide);\n  },\n\n  /**\n   * Shows the rotation popup for the given guide.\n   * @param {Guide} guide\n   */\n  showPopup(guide) {\n    this.popup.style.display = 'block';\n    this.selectedGuide = guide;\n    this.popupInput.value = this.selectedGuide.rotation;\n  },\n\n  /**\n   * Closes the rotation popup.\n   */\n  closePopup() {\n    this.popup.style.display = 'none';\n    this.popupInput.value = '';\n    this.selectedGuide = null;\n  },\n\n  /**\n   * Destroys the given guide if it is part of the viewer and removes it from the list of active guides.\n   * @param {Guide} guide\n   */\n  remove(guide) {\n    const index = this.guides.indexOf(guide);\n\n    if (index === -1) {\n      return;\n    }\n\n    this.guides.splice(index, 1);\n    guide.remove();\n  },\n\n  /**\n   * Removes and destroys all current guides from the instance.\n   */\n  removeAll() {\n    // The spread operator is to make sure the guides are correctly deleted in order when at the same time removing\n    // them from the array.\n    for (const guide of [...this.guides]) {\n      this.remove(guide);\n    }\n  },\n\n  // TODO: Refactor popup into new class\n  /**\n   * Creates a very basic popup for changing the rotation of the selected guide.\n   * @private\n   * @returns {HTMLDivElement}\n   */\n  createRotationPopup() {\n    const popup = document.createElement('div');\n    popup.id = 'osd-guide-popup';\n    popup.classList.add('osd-guide-popup');\n    popup.style.position = 'absolute';\n    popup.style.bottom = '10px';\n    popup.style.left = '10px';\n\n    const form = document.createElement('form');\n    form.classList.add('osd-guide-popup-form');\n    form.style.display = 'block';\n    form.style.position = 'relative';\n    form.style.background = '#fff';\n    form.style.padding = '10px';\n\n    popup.appendChild(form);\n\n    const input = document.createElement('input');\n    input.type = 'text';\n    input.style.display = 'inline-block';\n    input.style.width = '50px';\n    input.style.fontSize = '14px';\n    form.appendChild(input);\n\n    const rotateButton = document.createElement('button');\n    rotateButton.type = 'submit';\n    rotateButton.innerHTML = $.getString('Tool.rotate') || 'rotate';\n    rotateButton.style.fontSize = '14px';\n    rotateButton.classList.add('osd-guide-rotate-button');\n\n    rotateButton.addEventListener('click', () => {\n      this.selectedGuide.rotate(input.value);\n      this.closePopup();\n    });\n\n    form.appendChild(rotateButton);\n\n    const closeButton = document.createElement('button');\n    closeButton.innerHTML = '&times;';\n    closeButton.title = $.getString('Tool.close') || 'close';\n    closeButton.style.fontWeight = 'bold';\n    closeButton.style.fontSize = '14px';\n    closeButton.classList.add('osd-guide-close');\n    closeButton.addEventListener('click', () => {\n      this.closePopup();\n    });\n    form.appendChild(closeButton);\n\n    return popup;\n  }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}